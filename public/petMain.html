
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>宠物神殿</title>
<link rel="stylesheet" type="text/css" href="Content/petMain/css/reset.css" />
<link href="Content/petMain/css/mcsd.css" rel="stylesheet" />
<style>
	.sd_pet{
		cursor: pointer;}
		.yy {
	cursor:hand;
	opacity: 0.5;
filter : progid:DXImageTransform.Microsoft.Alpha(style=0, opacity=50, finishOpacity=100);
}
</style>
<script type="text/javascript">
		var sxcw="";
		$(function(){
		
		
		
		});

		function setTab(name, cursel, n) {
            for (i = 1; i <= n; i++) {
                var menu = document.getElementById(name + i);
                var con = document.getElementById("con_" + name + "_" + i);
                menu.className = i == cursel ? "on" : "";
                con.style.display = i == cursel ? "block" : "none";
            }
        }
		function loadHechengProp(JSON){
			var j = $.parseJSON(JSON);
			var value = $("#wp1").val();
			var value1 = $("#wp2").val();
			$(".合成道具列表").html("<option value='-1'>请选择材料</option>");
			for(var i = 0;i<j.length;i++){
				
				$(".合成道具列表").append("<option value='"+j[i].道具序号+"'>"+j[i].道具名字+"</option>");
				
			}
			$("#wp1").val(value).change();
			$("#wp2").val(value1).change();
		
		}
		function loadHechengPet(json){
	
				$("#cp1").hide();
			$("#cp2").hide();
			$("#zscp1").hide();
			$("#zscp2").hide();
			var value =  $("#comapets_a").val();
			
			var value1 =  $("#comapets_b").val();
			var value2 =  $("#zsapets_a").val();
			var value3 =  $("#zsbpets_b").val();
			var value4 =  $("#zs").val();
			var j = $.parseJSON(json);
			$(".宠物背包").html("");
			 $(".合成宠物列表").html("<option value=''>请选择宠物</option>");
		//	alert(JSON);
			var ii = 0;
			for(var i = 0;i<j.length;i++){
				ii++;
				if(j[i].状态=="0"){
					 $(".宠物背包").html($(".宠物背包").html()+"<div class=\"sd_pet r00\"><img  src=\"Content/PetPhoto/k"+j[i].形象+".gif\" onerror=\"this.src='Content/PetPhoto/k"+j[i].形象+".png'\" style=\"cursor:pointer;opacity: 1;filter : progid:DXImageTransform.Microsoft.Alpha(style=0, opacity=100, finishOpacity=100);\" id=\"i"+(i+1)+"\"/><span style='display:none' class='p4'>"+j[i].宠物序号+"</span></div>");
					 $(".进化ID").html(j[i].宠物序号);
				}else{
					 $(".宠物背包").html( $(".宠物背包").html()+"<div class=\"sd_pet r00 yy\"><img src=\"Content/PetPhoto/k"+j[i].形象+".gif\" onerror=\"this.src='Content/PetPhoto/k"+j[i].形象+".png'\" style=\"cursor:pointer;\" id=\"i"+(i+1)+"\"/><span style='display:none' class='p4'>"+j[i].宠物序号+"</span></div>");
					
				}
			
				if(j[i].五行!='神' && j[i].五行!='神圣'  && j[i].五行!='}' && j[i].五行!='人' && j[i].五行!='鬼' && j[i].五行!='巫' && j[i].五行!='仙'&& j[i].五行!='萌'&& j[i].五行!='佛'){
					if(j[i].宠物名字!='涅兽' && j[i].宠物名字.indexOf("涅重生")==-1){
						 $(".合成宠物列表:eq(0)").append("<option  value='"+j[i].宠物序号+"-k"+j[i].形象+".gif'>"+j[i].宠物名字+"-"+j[i].等级+"</option>");
						 $(".合成宠物列表:eq(1)").append("<option  value='"+j[i].宠物序号+"-k"+j[i].形象+".gif'>"+j[i].宠物名字+"-"+j[i].等级+"</option>");
					 }
				 }
				 if(j[i].五行=='神' || j[i].五行=='神圣' || j[i].五行=='}'|| j[i].五行=='人'|| j[i].五行=='鬼'|| j[i].五行=='巫' || j[i].五行=='仙'|| j[i].五行=='萌'|| j[i].五行=='佛'){ 
					if(j[i].宠物名字!='涅兽' && j[i].宠物名字.indexOf("涅重生")==-1){
						 $(".合成宠物列表:eq(2)").append("<option  value='"+j[i].宠物序号+"-k"+j[i].形象+".gif'>"+j[i].宠物名字+"-"+j[i].等级+"</option>");
						 $(".合成宠物列表:eq(3)").append("<option  value='"+j[i].宠物序号+"-k"+j[i].形象+".gif'>"+j[i].宠物名字+"-"+j[i].等级+"</option>");
					 }
				 }
				 if(j[i].宠物名字=='涅兽' || j[i].宠物名字.indexOf("涅重生")!=-1){
					  $(".合成宠物列表:eq(4)").append("<option  value='"+j[i].宠物序号+"-k"+j[i].形象+".gif'>"+j[i].宠物名字+"-"+j[i].等级+"</option>");
				}
				 
			}
			$(".sd_pet").click(function(){
				var i=$(this).find(".p4").html();
				getJH(i,this);
				sxcw=i;	
			});
			//for(var i = 0;i<3-ii;i++){
//				 $(".宠物背包").append("<div class='sd_pet r00' id='p2'><img src='Content/PetPhoto/nopet.gif'/></div>");
//				 alert($(".宠物背包").html())
//			}
			$("#comapets_a").val(value).change();
			$("#comapets_b").val(value1).change();
			$("#zsapets_a").val(value2).change();
			$("#zsbpets_b").val(value3).change();
		    $("#zs").val(value4).change();
			
			
		}
		function loadNiepanProp(json){
			var j = $.parseJSON(json);
			
			var value2 = $("#zswp1").val();
			var value3 = $("#zswp2").val();
			$(".合成道具列表1").html("<option value='-1'>请选择材料</option>");
			for(var i = 0;i<j.length;i++){
				
				$(".合成道具列表1").append("<option value='"+j[i].道具序号+"'>"+j[i].道具名字+"</option>");
				
			}
		
			$("#zswp1").val(value2).change();
			$("#zswp2").val(value3).change();
		}
		var APet=-1;
		var BPet=-1;
		function selectHCPET(){
			var A = $("#comapets_a").val();
			var B = $("#comapets_b").val();
		
			
			if(A!=''){
				$("#cp1").show();
				APet = A.split("-")[0];
				
				$("#cp1").attr("src","Content/PetPhoto/"+A.split("-")[1]);
				
				
			}else{
				APet = -1;
				$("#cp1").hide();
			}
			if(B!=''){
				BPet = B.split("-")[0];
				$("#cp2").show();
				$("#cp2").attr("src","Content/PetPhoto/"+B.split("-")[1]);
				
			}else{
				BPet = -1;
				$("#cp2").hide();
			}
			
		}
		var CPet=-1;
		var DPet=-1;
		var EPet=-1;
		function selectNPPET(){
			var A = $("#zsapets_a").val();
			var B = $("#zsbpets_b").val();
		
			var C = $("#zs").val();
			if(A!=''){
			
				CPet = A.split("-")[0];
				$("#zsp1").html("<img src=\"Content/PetPhoto/"+A.split("-")[1]+"\" onerror=\"this.src='Content/PetPhoto/"+A.split("-")[1].split(".")[0]+".png'\"  />");
			}else{
				CPet = -1;
				$("#zscp1").hide();
			}
			if(B!=''){
				DPet = B.split("-")[0];
				$("#zsp2").show();
				
				$("#zsp2").html("<img src=\"Content/PetPhoto/"+B.split("-")[1]+"\" onerror=\"this.src='Content/PetPhoto/"+B.split("-")[1].split(".")[0]+".png'\"  />");
				
			}else{
				DPet = -1;
				$("#zscp2").hide();
			}
			
			if(C!=''){
				EPet = C.split("-")[0];
				
			}else{
				EPet = -1;
				
			}
			
		}
		function getJH(i,t){
			$(".sd_pet").addClass("yy");
			
			$(".进化ID").html(i);
			readJH(window.external.getJH(i));
			$(t).removeClass("yy");


		}
		
		
		
		
		function readJH(json){
			
			var j = $.parseJSON(json);
		
			if(j.AI!=-1){
				$(".A进化材料").html(j.APN);
				$(".A进化等级").html(j.ALV);
				$(".A进化名字").html(j.AN);
			}else{
				$(".A进化名字").html("不可进化");	
			}
			
			if(j.BI!=-1){
				$(".B进化材料").html(j.BPN);
				$(".B进化等级").html(j.BLV);
				$(".B进化名字").html(j.BN);
			}else{
				$(".B进化名字").html("不可进化");	
			}
			
			
		}
		
    </script>
<script src="jquery-1.8.3.min.js"></script>
</head>
<body>
<div id="Layer1" style="cursor:pointer" onclick="window.parent.$('gw').src='./function/City_Mod.php?op=2'">
  <label></label>
</div>
<div class="task">
  <div class="task_left"></div>
  <div class="task_right">
    <ul class="task_nav">
      <li id="tab1" onclick="setTab('tab',1,5);" class="on"><a class="a01" href="javascript:void(0)"></a></li>
      <li id="tab2" onclick="setTab('tab',2,5);"><a class="a02" href="javascript:void(0)"></a></li>
      <li id="tab3" onclick="setTab('tab',3,5);"><a class="a03" href="javascript:void(0)"></a></li>
      <li id="tab4" onclick="setTab('tab',4,5);"><a class="a04" href="javascript:void(0)"></a></li>
      <li id="tab5" onclick="setTab('tab',5,5);"><a class="a05" href="javascript:void(0)"></a></li>
    </ul>
    <div class="dt_task" id="con_tab_1">
      <div class="sd_l">
        <p> 说明：进化需要满足条件，进化材料可以通过怪物掉落、开启进化箱、进化宝石兑换获得。 </p>
        <div class='sd_item 宠物背包'>
          
          
          <br/>
         
        
        </div>
   
      </div>
      <div class="sd_r">
      	<div class="sd_r">
            <div class="sd_step">
            <p>
                进化需求等级： <span class="A进化等级"></span><br/>
                进化所需金币： 1000<br/>
                进化所需材料： <span class="A进化材料"></span><br/>
                      进化后宠物：  <span class="A进化名字"></span><br/>
                        <a href="#"><img src="Content/petMain/img/sd04.jpg" alt="进化" border="0" onclick="JinHua('1')"></a>
                    </p>
                    </div>
                    <div class="sd_step">
                        <p>
                进化需求等级： <span class="B进化等级"></span> <br/>
                进化所需金币： 1000<br/>
                进化所需材料： <span class="B进化材料"></span><br/>
                进化后宠物： <span class="B进化名字"></span><br/>
                <a href="#"><img src="Content/petMain/img/sd05.jpg" alt="进化" border="0" onclick="JinHua('2')"></a>
                <div class="进化ID" style="display:none"></div>
                </p>
            </div>
            </div>
      </div>
    </div>
    <div class="dt_task con" id="con_tab_2">
      <div class="sd_hc_l">
        <div class="sd_hc_01">
          <div class="hc_pet_01" id="comp1"><img style="display:none" id="cp1"></div>
          <div class="hc_pet_02" id="comp2"><img style="display:none" id="cp2"></div>
        </div>
        <div class="sd_hc_02" id="hcxx">
          <input type='hidden' value='' id='hidd_bbal' />
          <table width='260' border='0' cellspacing='0' cellpadding='0'>
            <tbody>
              <tr>
                <td align='center'><select class="合成宠物列表" name='comapets' id='comapets_a' style='margin-top:3px;' onchange='selectHCPET();'>
                    <option value=''>请选择主宠物</option>
                  </select></td>
                <td align='center'><select class="合成宠物列表" name='comapets' id='comapets_b' style='margin-top:3px;' onchange='selectHCPET();'>
                    <option value=''>请选择副宠物</option>
                  </select></td>
              </tr>
              <tr>
              <tr>
                <td height='30' colspan='2' align='center'>合成宠物需要金币：<span id='smoney'>50000</span></td>
              </tr>
              </tr>
              
            </tbody>
          </table>
        </div>
      </div>
      <div class="sd_hc_r"> <b>合成等级限制：</b>主副宠物均需要40级<br/>
        <b>说明：</b><br/>
        1）添加的道具可以通过神秘商店、副本等获得；<br/>
        2）合成时请先取下宠物装备，否则宠物消失时装备也会一起消失；<br/>
        3）合成冷却为10秒，需等待冷却后才能继续合成；<br/>
        4）主宠成长45以上时有一定的几率随机出神宠。<br/>
        添加<span style="color:red;">守护</span>材料：
        <select class="合成道具列表" name="wp1" id="wp1" onchange="moneysum();">
          <option value='-1'>请选择材料</option>
        </select>
        <br/>
        添加<span style="color:red;">加成</span>材料：
        <select class="合成道具列表" name="wp2" id="wp2" onchange="moneysum();">
          <option value='-1'>请选择材料</option>
        </select>
        <br/>
        <table width="300" border="0" cellspacing="0" cellpadding="0" style="margin-top:10px;">
          <tbody>
            <tr>
              <td rowspan="2"><a href="#"><img src="Content/petMain/img/sdbtn.gif" alt="开始合成" onclick="Pcompose()" border="0" id="snb" class="开始合成"></a></td>
              <td>合成幸运星：</td>
            </tr>
            <tr>
              <td><a href="#"><img src="Content/petMain/img/gm15.gif" alt="合成幸运星说明" border="0" onclick="javascript:void(0);"></a></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div id="help" style="position:absolute; left:493px; top:30px; width:282px; height:150px; z-index:10;padding-top:3px;display:none">
        <table width="286" border="0" cellpadding="0" cellspacing="0">
          <tbody>
          
          <tr>
            <td>
            <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
              <tbody>
                <tr>
                  <td width="14"><img src="Content/petMain/img/bbz01.gif" width="14" height="29"></td>
                  <td style='background: url("Content/petMain/img/bbz02.gif") repeat-x; height: 29px; overflow: hidden;' heiht="2"><b><font color="green" style="font-size: 12px;">合成幸运星：</font></b></td>
                  <b><font color="green" style="font-size:12px;">合成幸运星：</font></b>
              </td>
              
              
                <td width="31"><img src="Content/petMain/img/bbz03.gif" width="31" height="29"></td>
              </tr>
              </tbody>
              
            </table>
            </td>
          </tr>
          <tr>
            <td height="100" valign="top" align="left" background="Content/petMain/img/bbz04.gif" style="font-size:12px;padding:10px;padding-top:0px;line-height:1.7;"><span style="margin-left:230px;color:#1c4ec1"><a href="javascript:document.getElementById('help').style.display='none';void(0);">关闭</a></span> <span id="helptarget" style="color:#333333;"> <br/>
              1.每合成失败一次，合成幸运星+1。<br/>
              2.合成幸运星越多，合成成功率就越高。<br/>
              3.当幸运星达到10颗时，合成率为100%。<br/>
              4.每合成成功一次，合成幸运星数量归0。<br/>
              5.合成成功率比以往已经大幅度提升。<br/>
              </span></td>
          </tr>

          <tr>
            <td height="12"><img src="Content/petMain/img/bbz05.gif" width="286" height="12"></td>
          </tr>
          </tbody>
          
        </table>
      </div>
    </div>
    <div class="dt_task con" id="con_tab_3">
      <div class="sd_hc_l">
        <div class="sd_hc_01">
          <div class="hc_pet_01" id="zsp1"><img src="" style="cursor:pointer;display:none;" id="zscp1"></div>
          <div class="hc_pet_02" id="zsp2"><img src="" style="cursor:pointer;display:none;" id="zscp2"></div>
        </div>
        <div class="sd_hc_02" id="zsxx">
          <input type='hidden' value='' id='hidd_bbalzs' />
          <table width='260' border='0' cellspacing='0' cellpadding='0'>
            <tbody>
              <tr>
                <td align='center'><select class="合成宠物列表" name='zsapets' id='zsapets_a' style='margin-top:3px;' onchange='selectNPPET();'>
                    <option value=''>请选择主宠物</option>
                  </select></td>
                <td align='center'><select class="合成宠物列表" name='zsapets' id='zsbpets_b' style='margin-top:3px;' onchange='selectNPPET();'>
                    <option value=''>请选择副宠物</option>
                  </select></td>
              </tr>
              <tr>
                  <td height="30" colspan="2" align="center">
                      请选择涅兽： <select class="合成宠物列表" onChange="selectNPPET();" name="select" id="zs">
                          <option value="">请选择涅兽</option>

                      </select>
                  </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="sd_hc_r"> <b>涅限制：</b>主副宠均需为神宠，60级以上<br/>
        <b>涅失败惩罚：</b>无 <br/>
        <b>说明：</b><br/>
        1）添加的道具可以通过神秘商店、副本等获得；<br/>
        2）放入涅兽c123可以将副宠的属性转移到主宠；<br/>
        3）装备在涅进行的时候将会自动卸下。<br/>
        添加材料一：
        <select class="合成道具列表1" name="zswp1" id="zswp1">
          <option value="-1">选择材料一</option>
        </select>
        <br/>
        添加材料二：
        <select class="合成道具列表1" name="zswp2" id="zswp2">
          <option value="-1">选择材料二</option>
        </select>
        <br/>
        <table width="300" border="0" cellspacing="0" cellpadding="0" style="margin-top:10px;">
          <tbody>
            <tr>
              <td><a href="#"><img id="npbtn" src="Content/petMain/img/sdbtn02.gif" alt="神宠涅" border="0" class="开始涅" onclick="zsPcompose()"></a></td>
              <td>每次涅消耗金币：50W</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<div id="Layer2" style="display:none"></div>
<div style="position: absolute; left: 250px; top: 20px; z-index: 10; width: 300px; height: 280px; border: 2px solid rgb(17, 17, 68); background-color: rgb(205, 172, 61); display:none; line-height:24px; color:#653E17; padding:5px" id="infotext"> </div>
<script language="javascript">
        // Display id.
        var bball = $("#hidd_bbal").val().split(',');
        var bball_zs = $("#hidd_bbalzs").val().split(',');
        var sszsbbid = 0;
        var styles = "";
        if (styles == 'compose') {
            setTab('tab', 2, 3);
        } else if (styles == 'zs') {
            setTab('tab', 3, 3);
        }
        var setBBId = 0;
        function Display(obj, id) {
            obj = obj.style;
            sel(obj);
            $.ajax({
                type: 'POST',
                url: '../Ajax_ashx/mcsd.ashx',
                data: 'bbid=' + id + '&&cztype=qh',
                success: function (msg) {
                    $(".sd_r").html(msg);
                }
            });
            
        }

        function Display1(obj, id, level, czl, type) {
            setBBId = id;
            sszsbbid = 0;
            obj = obj.style;
            sel(obj);
            if (level > 0 && type == 1) {
                $('bblevel').innerHTML = level;
                $('bbczl').innerHTML = czl;
            } else if (type == 2) {
                $('bblevel').innerHTML = '';
                $('bbczl').innerHTML = '';
            }
        }

        // Add by DuHao 2009-5-13
        function copyWord(words) {
            window.parent.$('baike_input').value = words;
        }
        // Jinhua function.
        function JinHua(jhtype) {
			//alert("引用成功！");
			var message=window.external.JinHua(sxcw,jhtype);
			if(message=="ss")
			{window.parent.showBox("进化成功！");
			window.external.updatePetMain_page();}
			else{
			window.parent.showBox(message);}
            
			        
        }



        function sel(obj) {
            for (var i = 1; i < 4; i++) {
                try {
                    document.getElementById("i"+i).style.opacity = "0.5";
                    document.getElementById("s" + i).style.opacity = "0.5";
                    document.getElementById("z" + i).style.opacity = "0.5";

                    
                } catch (e) {
                    var x = e;
                    continue;
                }
            }
            if (document.all) {
                obj.filter = "alpha(opacity=100)";
            } else {
                obj.opacity = 1;
            }
        }



        function Pcompose() {
            var prop1 = $("#wp1 option:selected").val();
            var prop2 = $("#wp2 option:selected").val();
			
            if (APet == -1) {
                window.parent.showBox("请选择一个主宠！");
	            return;
            }else if (BPet == -1){
                window.parent.showBox("请选择一个副宠！");
	            return;
            } else if (APet == BPet) {
                window.parent.showBox("主副宠不能选择同一个！");
	            return;
            } else {
           	 	window.parent.showBox(window.external.Hecheng(APet,BPet,prop1,prop2));
				  window.parent.jid=null;
			window.parent.jname="普通攻击";
            }


        }

        function moneysum() {

            var ap = document.getElementById('comapets_a').options[document.getElementById('comapets_a').selectedIndex].text.split('-')[1];
            var bp = document.getElementById('comapets_b').options[document.getElementById('comapets_b').selectedIndex].text.split('-')[1];
            var apid = document.getElementById('comapets_a').options[document.getElementById('comapets_a').selectedIndex].value;
            var bpid = document.getElementById('comapets_b').options[document.getElementById('comapets_b').selectedIndex].value;

            if (typeof apid != 'undefined' || apid != '') {
                for (var i = 0; i < bball.length; i++) {
                    var img1 = bball[i].split('-')[1];
                    if (bball[i].split('-')[0] == apid) {
                        document.getElementById('cp1').src = "Content/PetPhoto/" + img1;
                        document.getElementById('cp1').style.display = '';
                    }
                }
            }
            if (typeof bpid != 'undefined' || bpid != '') {
                for (var i = 0; i < bball.length; i++) {
                    var img1 = bball[i].split('-')[1];
                    if (bball[i].split('-')[0] == bpid) {
                        document.getElementById('cp2').src = "Content/PetPhoto/" + img1;
                        document.getElementById('cp2').style.display = '';
                    }
                }
            }

            var p1 = document.getElementById('wp1').options[document.getElementById('wp1').selectedIndex].text.split('-')[1];
            var p2 = document.getElementById('wp2').options[document.getElementById('wp2').selectedIndex].text.split('-')[1];
            if (typeof ap == 'undefined' || typeof bp == 'undefined') return false;
            if (p1 == '' || typeof p1 == 'undefined') p1 = 0;
            if (p2 == '' || typeof p2 == 'undefined') p2 = 0;
            var money = parseInt(parseInt(ap) + parseInt(bp)) * 1000 + parseInt(p1) + parseInt(p2);
            document.getElementById('smoney').innerHTML = 50000 + '金币！';
        }

        function playF(tf, style) {
            var oPopup = window.createPopup();
            var fname = '';
            if (tf == 1) fname = 'hcdh'; //ok
            else fname = 'hcdh0';
            var obj = document.getElementById('Layer2');
            with (obj) {
                style.backgroundColor = "#dfd495";
                style.display = 'block';
                //style.border="solid black 1px";
                innerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" '
                           + 'codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" width="305" height="185">'
                           + '<param name="movie" value="../images/ui/compose/' + fname + '.swf" />'
                           + '<param name="quality" value="high" />'
                           + '<param name="wmode" value="transparent" />'
                           + '<embed src="' + IMAGE_SRC_URL + '/ui/compose/' + fname + '.swf" quality="high" ' + 'pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="305" height="185"></embed></object>';
            }

            window.setTimeout(function () { document.getElementById('Layer2').style.display = 'none'; }, 5000);
            //window.parent.$('gw').src='./function/City_Mod.php';
        }

        function zsPcompose() {
            var zspet1 = CPet;
            var zspet2 = DPet;
            var zsprop1 = $("#zswp1 option:selected").val();
            var zsprop2 = $("#zswp2 option:selected").val();
            var pn =EPet;
            if (zspet1 == -1) {
                window.parent.showBox("请选择一个主宠！");
	            return;
            } else if (zspet2 == -1) {
                window.parent.showBox("请选择一个副宠！");
	            return;
            } else if (zspet1 == zspet2) {
                window.parent.showBox("主副宠不能选择同一个！");
	            return;
            }
            else if (pn == -1) {
                window.parent.showBox("请选择涅兽");
	            return;
            } else {
               window.parent.showBox(window.external.Niepang(CPet,DPet,zsprop1,zsprop2,pn));
			     window.parent.jid=null;
			window.parent.jname="普通攻击";
            }
        }

        function upHtml(mg) {
            var array = mg.split("^");
            $("#zsp1").html("<img src=' .image_src_url.'=' bb=' k119.gif'=' onclick='Display(239934);' style='cursor:pointer;display:none;' id='zscp1'>");
            $("#zsp2").html("<img src=' .image_src_url.'=' bb=' k119.gif'=' onclick='Display(239934);' style='cursor:pointer;display:none;' id='zscp2'>");
            $("#comp1").html("<img src=' .image_src_url.'=' bb=' k119.gif'=' onclick='Display(239934);' style='cursor:pointer;display:none;' id='cp1'>");
            $("#comp2").html("<img src=' .image_src_url.'=' bb=' k119.gif'=' onclick='Display(239934);' style='cursor:pointer;display:none;' id='cp1'>");
            $(".sd_l").html(array[0]);
            $(".sd_r").html(array[1]);
            $("#hcxx").html(array[2]);
            $("#wp1").html(array[3]);
            $("#wp2").html(array[3]);
            $("#zsxx").html(array[4]);
            $("#zswp1").html(array[5]);
            $("#zswp2").html(array[6]);
            window.parent.showBox(array[7]);
        }
        function zsmoneysum() {
            var ap = document.getElementById('zsapets_a').options[document.getElementById('zsapets_a').selectedIndex].text.split('-')[1];
            var bp = document.getElementById('zsbpets_b').options[document.getElementById('zsbpets_b').selectedIndex].text.split('-')[1];
            var apid = document.getElementById('zsapets_a').options[document.getElementById('zsapets_a').selectedIndex].value;
            var bpid = document.getElementById('zsbpets_b').options[document.getElementById('zsbpets_b').selectedIndex].value;

            if (typeof apid != 'undefined' || apid != '') {
                for (var i = 0; i < bball_zs.length; i++) {
                    var img1 = bball_zs[i].split('-')[1];
                    if (bball_zs[i].split('-')[0] == apid) {
                        document.getElementById('zscp1').src = "Content/PetPhoto/" + img1;
                        document.getElementById('zscp1').style.display = '';
                    }
                }
            }
            if (typeof bpid != 'undefined' || bpid != '') {
                for (var i = 0; i < bball_zs.length; i++) {
                    var img1 = bball_zs[i].split('-')[1];
                    if (bball_zs[i].split('-')[0] == bpid) {
                        document.getElementById('zscp2').src = "Content/PetPhoto/" + img1;
                        document.getElementById('zscp2').style.display = '';
                    }
                }
            }

            var p1 = document.getElementById('zswp1').options[document.getElementById('zswp1').selectedIndex].text.split('-')[1];
            var p2 = document.getElementById('zswp2').options[document.getElementById('zswp2').selectedIndex].text.split('-')[1];
            if (typeof ap == 'undefined' || typeof bp == 'undefined') return false;
            if (p1 == '' || typeof p1 == 'undefined') p1 = 0;
            if (p2 == '' || typeof p2 == 'undefined') p2 = 0;
          //  var money = parseInt(parseInt(ap) + parseInt(bp)) * 1000 + parseInt(p1) + parseInt(p2);
        }

        // Jinhua function.
        function ssJinHua() {
            if (setBBId == 0 || typeof (bbjs[setBBId]) == 'undefined') window.parent.Alert('请选择宠物');
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    if (t.responseText == 'OK') {
                        window.parent.Alert('进化成功');
                        rd();
                    }
                    else {
                        window.parent.Alert(t.responseText);
                    }
                },
                asynchronous: true
            };
	        var str = bbjs[setBBId];
            var strs = str.split('|');
            if (strs[6] != 7) {
                parent.Alert("请确认您的宠物是否为神圣宠物!");
                return;
            }
            if (parseInt(strs[7]) <= parseInt(strs[5])) {
                if (!confirm('您的宠物已经达到成长上限，进化不会产生任何变化，但会消耗材料及游戏币。')) {
                    return;
                }
            }
            var ajax = new Ajax.Request('../function/superJhGate.php?pid=' + setBBId + '&zjsxdj=' + $('zjsxdj').value, opt);
        }

        var bbjs = {};
        bbjs["239934"] = "N/A|83|N/A|N/A|0|22|6";
        bbjs["239928"] = "N/A|3|N/A|N/A|0|1.3|1";


        function showJHInfo(bid) {
            var str = bbjs[bid];
            var strs = str.split('|');
            var html = '<table width="210" cellspacing="0" cellpadding="0" border="0">\
			  <tbody><tr>\
				<td width="125">进化需要等级：'+ strs[0] + '</td>\
				<td width="85">当前等级：'+ (strs[6] < 7 ? 'N/A' : strs[1]) + '</td>\
				</tr>\
			  <tr>\
				<td colspan="2">进化所需材料：'+ strs[2] + '</td>\
				</tr>\
			  <tr>\
				<td colspan="2">进化所需金币：'+ strs[3] + '</td>\
				</tr>\
			  <tr>\
				<td colspan="2">当前进化次数：'+ (strs[6] < 7 ? 'N/A' : strs[4]) + ' <select name="zjsxdj" id="zjsxdj"><option>增加属性道具</option>' + '' + '</select></td>\
			  </tr>\
			  <tr>\
				<td><img width="79" height="24" src="../images/sd_cion01.jpg" style="cursor:pointer" onclick="displayInfo(0)" ></td>\
				<td><img width="79" height="24" src="../images/sd_cion02.jpg"  style="cursor:pointer" onclick="ssJinHua()"></td>\
			  </tr>\
			</tbody></table>';
            $('jhxq').innerHTML = html;
            var nm = '不可抽取';

            if (strs[6] < 7) {
                if (strs[5] > 600) {
                    nm = 600 * 10000;
                } else {
                    nm = strs[5] * 10000;
                }
            }

            $('cqjb').innerHTML = parseInt(nm);

            /*if(strs[6]==7) $('hascz').innerHTML=strs[5];
            else $('hascz').innerHTML='不可转化';*/
        }

        var infs = [
        '1.每一个神圣宠物最多能进化10次；<br/>\
2.神圣宠物的进化必须满足进化等级要求；<br/>\
3.进化成功之后，宠物等级变为1级；<br/>\
4.当宠物成长已经达到该阶段成长上限时，进化不会再增加其成长。<br/>\
',
        '1.	只有神宠能使用成长抽取功能；<br/>\
2.	神宠的成长抽取按照不同阶段抽取的比例不同，成长越高，抽取的比例越高；<br/>\
3.	所抽取的成长最大不能超过600，超过600时只按600计算；<br/>\
4.	可以通过添加道具的方式增加成长抽取比例（可以在副本中获得道具碎片，也可以在神秘商店中直接购买道具）；<br/>\
5.	抽取完成后宠物将会消失。<br/>\
',
        '1.只有神圣宠物才能接受成长的直接转化；<br/>\
2.转化成长，需要手动输入转化数字，只能输入整数；<br/>\
3.当转化成长率超过该神圣宠物当前上限时，多出的成长将消失。<br/>\
',
        '1.神圣宠物通过转生可以提高其成长上限及等级上限；<br />\
2.转生需要满足转生等级及成长要求，同时还需要有对应的转生道具；<br />\
3.转生并不是百分之百成功，一旦失败，转生材料将会消失；<br />\
4.可以通过购买的增加成功率道具来增加转生的成功几率。<br />\
'
        ];

        function displayInfo(id) {
            $('infotext').innerHTML = '' + infs[id] + '<br/><input type="button" value="关闭" onclick="$(\'infotext\').style.display=\'none\'" style="position:absolute;left:135px">';
            $('infotext').style.display = 'block';
        }


        function chouqu() {
            if (setBBId == 0 || typeof (bbjs[setBBId]) == 'undefined') window.parent.Alert('请选择宠物');
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    if (t.responseText.substr(0, 2) == 'OK') {
                        window.parent.Alert('抽取成功,抽取获得了:' + t.responseText.substr(2, 6) + '成长');
                        //rd();
                        window.location = '/function/Sd_Mod.php';
                    }
                    else {
                        window.parent.Alert(t.responseText);
                    }
                },
                asynchronous: true
            };
	        var str = bbjs[setBBId];
            var strs = str.split('|');
            /*
            if(strs[6]!=6){
                if(strs[5]<40){
                    parent.Alert("五系宠物成长小于40不能抽取!");
                    return;
                }
            }
            */

            if (strs[5] < 30) {
                parent.Alert("成长小于30不能抽取!");
                return;
            }
            if (strs[6] != 6) {
                if (!confirm('抽取成长在5%-15%之间随机一个数值\n\n确认宠物装备是否脱下，否则抽取完装备将会消失\n\n抽取完成之后宠物将消失。\n\n确定么?')) return;
            } else {
                if (strs[5] < 65) {
                    swapRate = "10%-20%之间随机一个数值";
                }
                else if (strs[5] < 85) {
                    swapRate = "30%-50%之间随机一个数值";
                }
                else if (strs[5] < 100) {
                    swapRate = "50%-65%之间随机一个数值";
                }
                else if (strs[5] < 110) {
                    swapRate = "65%";
                }
                else if (strs[5] < 115) {
                    swapRate = "70%";
                }
                else if (strs[5] < 120) {
                    swapRate = "75%";
                }
                else {
                    swapRate = "80%";
                }
                if (!confirm('抽取成长比例：' + swapRate + '(不包含道具的效果)\n\n抽取完成后，宠物不会消失，成长变为1\n\n已经抽取过成长的神宠不能进行涅，不能进行传承。,\n\n确定么?')) return;
            }
            var ajax = new Ajax.Request('../function/cqGate.php?act=cq&pid=' + setBBId + "&pid1=" + $('zjcqbldj1').value + "&pid2=" + $('zjcqbldj2').value, opt);
        }

        function zhuanhua() {
            if (setBBId == 0 || typeof (bbjs[setBBId]) == 'undefined') window.parent.Alert('请选择宠物');
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    if (t.responseText == 'OK') {
                        window.parent.Alert('转化成功');
                        rd();
                    }
                    else {
                        window.parent.Alert(t.responseText);
                    }
                },
                asynchronous: true
            };
	        var str = bbjs[setBBId];
            var strs = str.split('|');
            if (strs[6] != 7) {
                parent.Alert("该宠物不能进行转化!");
                return;
            }
            if (parseInt($('zhvalue').value) < 1 || isNaN(parseInt($('zhvalue').value))) {
                parent.Alert("请输入你要转化的点数,只允许数字!");
                return;
            } else {
                $('zhvalue').value = parseInt($('zhvalue').value);
            }
            if (parseInt(strs[7]) < parseInt($('zhvalue').value) + parseInt(strs[5])) {
                if (!confirm('抽取的成长加原有成长超出最大成长上限' + (parseInt($('zhvalue').value) + parseInt(strs[5]) - parseInt(strs[7])) + '点，多出的成长将会消失,确定要转化？')) {
                    return;
                }
            }

            var ajax = new Ajax.Request('../function/zhGate.php?act=zh&pid=' + setBBId + "&v=" + $('zhvalue').value, opt);
        }

        function sszsshow(bid) {
            if (bid == 0) {
                $('sszsimg').innerHTML = '';
                return;
            }
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    var res = t.responseText;
                    $('sszsimg').innerHTML = res;
                },
                on404: function (t) {
                },
                onFailure: function (t) {
                },
                asynchronous: true
            };
	        var ajax = new Ajax.Request('../function/sszsInfo.php?id=' + bid + '&op=img', opt);
        }

        function sszsstr(bid, sid, obj) {
            if (bid == 0 && sid == 0) {
                //$('sszsstr').innerHTML = '';
                //$('sszsstr1').style.display = 'none';
                return;
            }

            for (var i = 1; i < 10; i++) {
                try {
                    if (bid != i) seta($('p_p' + i).getElementsByTagName('img')[0].style, 0.5);
                    else seta($('p_p' + i).getElementsByTagName('img')[0].style, 1);
                } catch (e) { }
            }
            seta(obj.style, 1);
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    var res = t.responseText;
                    $('sszsstr').innerHTML = res;
                    $('sszsstr1').style.display = 'block';
                },
                on404: function (t) {
                },
                onFailure: function (t) {
                },
                asynchronous: true
            };
	        var ajax = new Ajax.Request('../function/sszsInfo.php?id=' + bid + '&sid=' + sid + '&op=str', opt);
        }

        function sszs() {
            var wp1 = $('sszswp1').options[$('sszswp1').selectedIndex].value;
            var wp2 = $('sszswp2').options[$('sszswp2').selectedIndex].value;
            if (wp1 == "" && wp2 == "") {
                if (!confirm('未放入成功率道具，可能会导致失败材料消失，\n\n如果您宠物身上有装备，转生后装备会消失，\n\n您确定要转生吗？')) {
                    return;
                }
            } else if (!confirm('如果您宠物身上有装备，转生后装备会消失，是否确定转生？')) {
                return;
            }
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    var res = t.responseText;
                    if (res == 5) {
                        playF(1, 'sszs');
                    } else if (res == 6) {
                        playF(0, 'sszs');
                    } else {
                        window.parent.Alert(res);
                    }
                },
                on404: function (t) {
                },
                onFailure: function (t) {
                },
                asynchronous: true
            };
	        var ajax = new Ajax.Request('../function/sszsInfo.php?old=' + setBBId + '&newid=' + sszsbbid + '&wp1=' + wp1 + '&wp2=' + wp2 + '&op=zs', opt);
        }
        function rd() {
            parent.$('gw').contentWindow.location.reload();
        }
        function seta(sty, v) {
            if (document.all) {
                sty.filter = "alpha(opacity=" + v * 100 + ")";
            } else {
                sty.opacity = v;
            }
        }
        setBBId = 239934; sszsshow(0); sszsstr(0, 0, this);
    </script> 

<!-- Visual Studio Browser Link --> 
<script type="application/json" id="__browserLink_initializationData">
    {"appName":"Chrome","requestId":"cdf3e9e670824924b42e6a6a1a197636"}
</script> 
<script type="text/javascript" src="http://localhost:5937/0b90675ff8384cf3a038470129e44aea/browserLink" async></script> 
<!-- End Browser Link -->

</body>
