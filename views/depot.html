
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
    <title>仓库</title>
    <link href="Content/CSS/main.css" rel="stylesheet" />
    <link href="Content/CSS/Depot.css" rel="stylesheet" />
    <script src="Content/Javascript/jquery-1.8.3.min.js"></script>
<script type="text/JavaScript">
<!--
function MM_jumpMenu(targ,selObj,restore){ //v3.0
  eval(targ+".location='"+selObj.options[selObj.selectedIndex].value+"'");
  if (restore) selObj.selectedIndex=0;
}

/* added by Zheng.Ping */
function hiddenContent() {
    $('props_types').style.display = 'none';
}

function showContent() {
    $('props_types').style.display = '';
}
var bid = 0;
var selid = 0;
var types = -1;
function readPropList(json){
	  $(".背包列表").html("");
			var j = $.parseJSON(json);
			var node="<tr class=\"row\" >"+
			      "<td class=\"wpid\"style='display:none'>{ID}</td>"+
				  "<td width=\"35px\"><img style=\"width:25px;height:25px;\" src=\"Content/Img/prop/{ICO}.gif\"></td>"+
				  "<td class=\"p2\" width=\"110px\" id=\"t{ID}\" style=\"cursor:pointer;text-align:left\" onMouseOver=\"showTip(660509,0,1,2);this.style.border='solid 1px #DFD496';\" onMouseOut=\"this.style.border=0;\">{Name}</td>"+
				  "<td class=\"p3\" width=\"60px\" style=\"text-align:left\">{price}</td>"+
				  "<td style=\"text-align:left\">{num}</td>"+
			  "</tr>";
			
			for(var i = 0;i<j.length;i++){
				var jnode = node.replace("{ICO}",j[i].道具图标);
				jnode = jnode.replace("{Name}",j[i].道具名字);
				jnode = jnode.replace("{Type}","道具");
				jnode = jnode.replace("{num}",j[i].道具数量);
				jnode = jnode.replace("{ID}",j[i].道具序号);
			    jnode = jnode.replace("{ID}",j[i].道具序号);
				jnode = jnode.replace("{price}",j[i].道具价格);
				jnode = jnode.replace("{price}",j[i].道具价格);
				$(".背包列表").append(jnode);
			  
			}	
			$(".道具数量").html(j.length);
			$(".背包列表 tr").click(function(){
				sel(this);
				bid=$(this).find(".wpid").html();
				price=$(this).find(".p3").html();
				ready_put();
				 　
			});
	$(".背包列表 tr").mouseover(function(e){
				
				 　e = e||window.event;
				   window.parent.hoveWp(e,this,"#FFF",$(this).find(".wpid").html(),true);
	});
	$(".背包列表 tr").mouseout(function(e){
				
				 
				   window.parent.hoveWp1hide();
			});

}
function readDepotList(json){
	$(".仓库列表").html("");
			  $(".仓库数量").html("0");
			var j = $.parseJSON(json);
			var node="<tr class=\"row\">"+
			      "<td class=\"wpid\"style='display:none'>{ID}</td>"+
				  "<td width=\"35px\"><img style=\"width:25px;height:25px;\" src=\"Content/Img/prop/{ICO}.gif\"></td>"+
				  "<td class=\"p2\" width=\"110px\" id=\"t{}\" style=\"cursor:pointer;text-align:left\" onMouseOver=\"showTip(660509,0,1,2);this.style.border='solid 1px #DFD496';\" onMouseOut=\"this.style.border=0;\" onClick=\"copyWord('进化之书');\">{Name}</td>"+
				  "<td class=\".p3\" width=\"60px\" style=\"text-align:left\">{price}</td>"+
				  "<td style=\"text-align:left\">{num}</td>"+
			  "</tr>";
			  
			for(var i = 0;i<j.length;i++){
				var jnode = node.replace("{ICO}",j[i].道具图标);
				jnode = jnode.replace("{Name}",j[i].道具名字);
				jnode = jnode.replace("{Type}","道具");
				jnode = jnode.replace("{num}",j[i].道具数量);
				jnode = jnode.replace("{ID}",j[i].道具序号);
			    jnode = jnode.replace("{ID}",j[i].道具序号);
				jnode = jnode.replace("{price}",j[i].道具价格);
				jnode = jnode.replace("{price}",j[i].道具价格);
				$(".仓库列表").append(jnode);
			  
			}	
			$(".仓库数量").html(j.length);
			$(".仓库列表 tr").click(function(){
				sel(this);
				bid=$(this).find(".wpid").html();
				price=$(this).find(".p3").html();
				ready_fetch();
				 　
			});
	$(".仓库列表 tr").mouseover(function(e){
				
				 　e = e||window.event;
				   window.parent.hoveWp(e,this,"#FFF",$(this).find(".wpid").html(),true);
	});
	$(".仓库列表 tr").mouseout(function(e){
				
				 
				   window.parent.hoveWp1hide();
			});
}
function showUserInfo(json){
				
	        $(".道具容量").html(json);
			
		}
/* addded by Zheng.Ping */
//-->
    </script>

</head>



<body>
    <div id="Layer1" style="cursor:pointer" onClick="window.parent.$('gw').src='./function/City_Mod.php'">
        <label></label>
    </div>
    <div class="task">
        <div class="task_left"></div>

        <div class="task_right">
            <div class="task_dh">
                <div class="task_dh01"></div>
            </div>
            <div class="box">
                <div class="box01">
                    <div class="box02">
                        <div class="bb01"><img src="Content/Img/Depot/icon03.jpg" width="65" height="25"></div>
                       
                    </div>
                    <div class="box03">
                        <table border="0" cellspacing="0" class="tit01">
                            <tbody>
                                <tr>
                                    <td height="24" style="width:35px; text-align:left"></td>
                                    <td style="width:100px; text-align:left">名称</td>
                                    <td style="width:60px; text-align:left">价格</td>
                                    <td style="text-align:left">数量</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="dt_list clearfix">
                            <table class="tit01" id="shoplist">
                                <tbody class="仓库列表">
                                    
                                    
                                </tbody>
                            </table>
                            <div style=" display:none;width:100%;text-align:left;font-size:12px; line-height:1.5;height:205px;overflow:auto;scrollbar-face-color:#E1D395;scrollbar-highlight-color:#ffffff;scrollbar-3dlight-color:#E1D395;scrollbar-shadow-color:#ffffff;scrollbar-darkshadow-color:#F3EDC9;scrollbar-track-color:#F3EDC9;scrollbar-arrow-color:#ffffff;cursor:default;color:#BF7D1A;margin-left:3px;" id="abc">
                                新建密码：<input type="password" name="pwd" id="pwd"><br><br>
                                重复密码：<input type="password" name="repwd" id="repwd"><br><br>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="submit" name="Submit" onClick="jiami()" value="提交" hidefocus="">&nbsp;&nbsp;&nbsp;&nbsp;
                                <input type="button" name="Submit2" value="取消" onClick="pwd2()" hidefocus="">

                            </div>
                        </div>
                    </div>
                    <div class="box04" style="font-size:12px">
                        空间：<span class="仓库数量">0</span> &nbsp;背包仓库总容量：<span class="道具容量"></span>
                        <input id="button_fetch_props" name="button" type="button" style="background-image:url(Content/Img/Depot/gm13.gif);border:0px;width:39px;height:15px;color:#2F291D;cursor:pointer;" disabled="" onClick="gets();" value="取出">
                        <input id="button_put_props" name="button" type="button" style="background-image:url(Content/Img/Depot/gm13.gif);border:0px;width:39px;height:15px;color:#2F291D;cursor:pointer;" disabled="" onClick="saves();" value="存放">
                    </div>
                </div>
                <div class="box01">
                    <div class="box02">
                        <div class="bb01"><img src="Content/Img/Depot/icon04.jpg" width="65" height="25"></div>
                       
                    </div>
                    <div class="box03">
                        <table border="0" cellspacing="0" class="tit01">
                            <tbody>
                               <tr>
                                    <td height="24" style="width:35px; text-align:left"></td>
                                    <td style="width:100px; text-align:left">名称</td>
                                    <td style="width:60px; text-align:left">价格</td>
                                    <td style="text-align:left">数量</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="dt_list clearfix">
                            <table class="tit01" id="shoplist">
                                <tbody class="背包列表">
                                  
                                   
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="box04" style="font-size:12px">
                        <label>空间：<span class="道具数量"></span>&nbsp;背包仓库总容量：<span class="道具容量"></span></label>
                        <a href="#" onClick="pwd()"><img src="Content/Img/Depot/add01.gif" border="0"></a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script language="javascript">
        // Add by DuHao 2009-5-13
        function copyWord(words) {
            window.parent.$('baike_input').value = words;
        }
        function sel(obj) {
			
            $(".row").css("background-color",'#fff');
            
		
            obj.style.backgroundColor = '#DFD496';
            //var obj = document.getElementById("num");
           
        }

        function gets() {
            
            if (bid == 0) { window.parent.Alert('请先选择要取出的物品。'); return; }
            else {
               if(window.external.toPack(bid)){
					window.parent.Alert("取出成功!");	
					window.external.updateDepot_page();
				}else{
					window.parent.Alert("空间不足!背景最大容量为120!");	
					
				}
            }
        }

        // added by Zheng.Ping
        function ready_fetch() {
			
        
			$('#button_put_props').attr("disabled","disabled");//添加disabled属性
			
			$('#button_fetch_props').removeAttr("disabled"); //移除disabled属性 
		
        }

        function ready_put() {
			$('#button_fetch_props').attr('disabled',"disabled");//添加disabled属性
			$('#button_put_props').removeAttr("disabled"); //移除disabled属性 
   			
        }

        // added by Zheng.ping

        function saves() {
        
			
			
            if (bid == 0) { window.parent.Alert('请先选择要存放的物品。'); return; }
            else {
                if(window.external.toDepot(bid)){
					window.parent.Alert("放入成功!");	
					window.external.updateDepot_page();
				}else{
					window.parent.Alert("空间不足!仓库最大容量为100!");	
					
				}
            }
        }
        var equipInfos = {};
        var LastKey = "";
        if (!document.all) {
            var Event;
            window.onmousemove = function () {
                Event = window.parent.event;
            };
        }

        function showTip(id, bid, sign, type) {
            var x = 500;
            var y = 100;
            equipInfos = window.parent.equipInfos;
            var key = id + "_" + bid + "_" + sign + "_" + type;
            if (typeof (equipInfos[key]) != 'undefined') {
                window.parent.showTips(equipInfos[key], x, y);
                return;
            }
            if (LastKey == key) {
                return;
            }
            LastKey = key;
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    equipInfos[key] = t.responseText;
                    window.parent.showTips(t.responseText, x, y);
                },
                on404: function (t) {
                },
                onFailure: function (t) {
                },
                asynchronous: true
            };
	        var ajax = new Ajax.Request('../function/getPropsInfo.php?id=' + id + '&bid=' + bid + '&sign=' + sign + '&type=' + type, opt);
        }

        function pwd() {
            $('abc').style.display = "";
            $('shoplist').style.display = "none";
        }

        function pwd2() {
            $('abc').style.display = "none";
            $('shoplist').style.display = "";
        }

        function jiami() {
            var pwd = $('pwd').value;
            var repwd = $('repwd').value;
            if (pwd == "") {
                window.parent.Alert("请先填写密码！");
                return false;
            }
            if (repwd == "") {
                window.parent.Alert("请先填写重复密码！");
                return false;
            }
            if (repwd != pwd) {
                window.parent.Alert("两次密码不一致！");
                return false;
            }
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    var n = parseInt(t.responseText);
                    if (n == 0) {
                        window.parent.Alert("请先填写密码！");
                        return false;
                    }
                    else if (n == 1) {
                        window.parent.Alert("请先填写重复密码！");
                        return false;
                    }
                    else if (n == 2) {
                        window.parent.Alert("两次密码不一致！");
                        return false;
                    }
                    else if (n == 3) {
                        window.parent.Alert("您的仓库已经设置密码,如要修改，请先输入旧密码！");
                        return false;
                    }
                    else if (n == 4) {
                        window.parent.Alert("您输入的密码长度不正确！");
                        return false;
                    }
                    else if (n == 10) {
                        if (!confirm("请牢记您的密码！！如若遗忘，后果自负！您确定要设置密码吗？")) {
                            return false;
                        }
                        dos(pwd);
                    }
                    else {
                        window.parent.Alert("设置密码失败！");
                    }
                },
                on404: function (t) {
                },
                onFailure: function (t) {
                },
                asynchronous: true
            };
	        var ajax = new Ajax.Request('../function/ext_Base.php?pwd=' + pwd + '&repwd=' + repwd + '&action=reg', opt);
        }

        //设置密码
        function dos(pwd) {
            if (pwd == "") {
                window.parent.Alert("信息有误！");
                return false;
            }
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    var n = parseInt(t.responseText);
                    if (n == 0) {
                        window.parent.Alert("住处有误");
                        return false;
                    }
                    else if (n == 10) {
                        window.location.href = '../function/Base_Mod.php';
                        window.parent.Alert("密码设置成功！");
                    }
                },
                on404: function (t) {
                },
                onFailure: function (t) {
                },
                asynchronous: true
            };
	        var ajax = new Ajax.Request('../function/ext_Base.php?pwd=' + pwd + '&action=do', opt);
        }

        //登陆
        function login() {
            var pwd = $('login').value;
            if (pwd == "") {
                window.parent.Alert("请先填写密码！");
                return false;
            }
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    var n = parseInt(t.responseText);
                    if (n == 0) {
                        window.parent.Alert("请先填写密码！");
                        return false;
                    }
                    else if (n == 1) {
                        window.parent.Alert("密码错误！");
                    }
                    else if (n == 10) {
                        window.location.href = '../function/Base_Mod.php';
                    }
                },
                on404: function (t) {
                },
                onFailure: function (t) {
                },
                asynchronous: true
            };
	        var ajax = new Ajax.Request('../function/ext_Base.php?pwd=' + pwd + '&action=login', opt);
        }

        //修改密码
        function update() {
            var pwd = $('login').value;
            if (pwd == "") {
                window.parent.Alert("请先填写旧密码！");
                return false;
            }
            var opt = {
                method: 'get',
                onSuccess: function (t) {
                    var n = parseInt(t.responseText);
                    if (n == 0) {
                        window.parent.Alert("请先填写旧密码！");
                        return false;
                    }
                    else if (n == 1) {
                        window.parent.Alert("密码错误！");
                    }
                    else if (n == 10) {
                        $('abc').style.display = "";
                        $('shoplist').style.display = "none";
                    }
                },
                on404: function (t) {
                },
                onFailure: function (t) {
                },
                asynchronous: true
            };
	        var ajax = new Ajax.Request('../function/ext_Base.php?pwd=' + pwd + '&action=login', opt);
        }
    </script>
    <div id="qq-sendUrl-btn"></div>
</body>
</html>